{"ast":null,"code":"import { __extends } from \"tslib\";\nimport PDFObject from \"./PDFObject\";\nimport CharCodes from \"../syntax/CharCodes\";\nimport { copyStringIntoBuffer, padStart, utf16Decode, pdfDocEncodingDecode, toCharCode, parseDate, hasUtf16BOM } from \"../../utils\";\nimport { InvalidPDFDateStringError } from \"../errors\";\nvar PDFString = /** @class */function (_super) {\n  __extends(PDFString, _super);\n  function PDFString(value) {\n    var _this = _super.call(this) || this;\n    _this.value = value;\n    return _this;\n  }\n  PDFString.prototype.asBytes = function () {\n    var bytes = [];\n    var octal = '';\n    var escaped = false;\n    var pushByte = function pushByte(byte) {\n      if (byte !== undefined) bytes.push(byte);\n      escaped = false;\n    };\n    for (var idx = 0, len = this.value.length; idx < len; idx++) {\n      var char = this.value[idx];\n      var byte = toCharCode(char);\n      var nextChar = this.value[idx + 1];\n      if (!escaped) {\n        if (byte === CharCodes.BackSlash) escaped = true;else pushByte(byte);\n      } else {\n        if (byte === CharCodes.Newline) pushByte();else if (byte === CharCodes.CarriageReturn) pushByte();else if (byte === CharCodes.n) pushByte(CharCodes.Newline);else if (byte === CharCodes.r) pushByte(CharCodes.CarriageReturn);else if (byte === CharCodes.t) pushByte(CharCodes.Tab);else if (byte === CharCodes.b) pushByte(CharCodes.Backspace);else if (byte === CharCodes.f) pushByte(CharCodes.FormFeed);else if (byte === CharCodes.LeftParen) pushByte(CharCodes.LeftParen);else if (byte === CharCodes.RightParen) pushByte(CharCodes.RightParen);else if (byte === CharCodes.Backspace) pushByte(CharCodes.BackSlash);else if (byte >= CharCodes.Zero && byte <= CharCodes.Seven) {\n          octal += char;\n          if (octal.length === 3 || !(nextChar >= '0' && nextChar <= '7')) {\n            pushByte(parseInt(octal, 8));\n            octal = '';\n          }\n        } else {\n          pushByte(byte);\n        }\n      }\n    }\n    return new Uint8Array(bytes);\n  };\n  PDFString.prototype.decodeText = function () {\n    var bytes = this.asBytes();\n    if (hasUtf16BOM(bytes)) return utf16Decode(bytes);\n    return pdfDocEncodingDecode(bytes);\n  };\n  PDFString.prototype.decodeDate = function () {\n    var text = this.decodeText();\n    var date = parseDate(text);\n    if (!date) throw new InvalidPDFDateStringError(text);\n    return date;\n  };\n  PDFString.prototype.asString = function () {\n    return this.value;\n  };\n  PDFString.prototype.clone = function () {\n    return PDFString.of(this.value);\n  };\n  PDFString.prototype.toString = function () {\n    return \"(\" + this.value + \")\";\n  };\n  PDFString.prototype.sizeInBytes = function () {\n    return this.value.length + 2;\n  };\n  PDFString.prototype.copyBytesInto = function (buffer, offset) {\n    buffer[offset++] = CharCodes.LeftParen;\n    offset += copyStringIntoBuffer(this.value, buffer, offset);\n    buffer[offset++] = CharCodes.RightParen;\n    return this.value.length + 2;\n  };\n  // The PDF spec allows newlines and parens to appear directly within a literal\n  // string. These character _may_ be escaped. But they do not _have_ to be. So\n  // for simplicity, we will not bother escaping them.\n  PDFString.of = function (value) {\n    return new PDFString(value);\n  };\n  PDFString.fromDate = function (date) {\n    var year = padStart(String(date.getUTCFullYear()), 4, '0');\n    var month = padStart(String(date.getUTCMonth() + 1), 2, '0');\n    var day = padStart(String(date.getUTCDate()), 2, '0');\n    var hours = padStart(String(date.getUTCHours()), 2, '0');\n    var mins = padStart(String(date.getUTCMinutes()), 2, '0');\n    var secs = padStart(String(date.getUTCSeconds()), 2, '0');\n    return new PDFString(\"D:\" + year + month + day + hours + mins + secs + \"Z\");\n  };\n  return PDFString;\n}(PDFObject);\nexport default PDFString;","map":{"version":3,"mappings":"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","names":["PDFObject","CharCodes","copyStringIntoBuffer","padStart","utf16Decode","pdfDocEncodingDecode","toCharCode","parseDate","hasUtf16BOM","InvalidPDFDateStringError","__extends","value","_super","_this","PDFString","bytes","octal","escaped","pushByte","byte","undefined","push","idx","len","length","char","nextChar","BackSlash","Newline","CarriageReturn","n","r","t","Tab","b","Backspace","f","FormFeed","LeftParen","RightParen","Zero","Seven","parseInt","Uint8Array","asBytes","text","decodeText","date","of","buffer","offset","year","String","getUTCFullYear","month","getUTCMonth","day","getUTCDate","hours","getUTCHours","mins","getUTCMinutes","secs","getUTCSeconds"],"sourceRoot":"","sources":["../../../src/core/objects/PDFString.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}