{"ast":null,"code":"import { CombedTextLayoutError } from \"../errors\";\nimport { TextAlignment } from \"./alignment\";\nimport { cleanText, lineSplit, mergeLines, charAtIndex, charSplit } from \"../../utils\";\nvar MIN_FONT_SIZE = 4;\nvar MAX_FONT_SIZE = 500;\nvar computeFontSize = function (lines, font, bounds, multiline) {\n  if (multiline === void 0) {\n    multiline = false;\n  }\n  var fontSize = MIN_FONT_SIZE;\n  while (fontSize < MAX_FONT_SIZE) {\n    var linesUsed = 0;\n    for (var lineIdx = 0, lineLen = lines.length; lineIdx < lineLen; lineIdx++) {\n      linesUsed += 1;\n      var line = lines[lineIdx];\n      var words = line.split(' ');\n      // Layout the words using the current `fontSize`, line wrapping\n      // whenever we reach the end of the current line.\n      var spaceInLineRemaining = bounds.width;\n      for (var idx = 0, len = words.length; idx < len; idx++) {\n        var isLastWord = idx === len - 1;\n        var word = isLastWord ? words[idx] : words[idx] + ' ';\n        var widthOfWord = font.widthOfTextAtSize(word, fontSize);\n        spaceInLineRemaining -= widthOfWord;\n        if (spaceInLineRemaining <= 0) {\n          linesUsed += 1;\n          spaceInLineRemaining = bounds.width - widthOfWord;\n        }\n      }\n    }\n    // Return if we exceeded the allowed width\n    if (!multiline && linesUsed > lines.length) return fontSize - 1;\n    var height = font.heightAtSize(fontSize);\n    var lineHeight = height + height * 0.2;\n    var totalHeight = lineHeight * linesUsed;\n    // Return if we exceeded the allowed height\n    if (totalHeight > Math.abs(bounds.height)) return fontSize - 1;\n    fontSize += 1;\n  }\n  return fontSize;\n};\nvar computeCombedFontSize = function (line, font, bounds, cellCount) {\n  var cellWidth = bounds.width / cellCount;\n  var cellHeight = bounds.height;\n  var fontSize = MIN_FONT_SIZE;\n  var chars = charSplit(line);\n  while (fontSize < MAX_FONT_SIZE) {\n    for (var idx = 0, len = chars.length; idx < len; idx++) {\n      var c = chars[idx];\n      var tooLong = font.widthOfTextAtSize(c, fontSize) > cellWidth * 0.75;\n      if (tooLong) return fontSize - 1;\n    }\n    var height = font.heightAtSize(fontSize, {\n      descender: false\n    });\n    if (height > cellHeight) return fontSize - 1;\n    fontSize += 1;\n  }\n  return fontSize;\n};\nvar lastIndexOfWhitespace = function (line) {\n  for (var idx = line.length; idx > 0; idx--) {\n    if (/\\s/.test(line[idx])) return idx;\n  }\n  return undefined;\n};\nvar splitOutLines = function (input, maxWidth, font, fontSize) {\n  var _a;\n  var lastWhitespaceIdx = input.length;\n  while (lastWhitespaceIdx > 0) {\n    var line = input.substring(0, lastWhitespaceIdx);\n    var encoded = font.encodeText(line);\n    var width = font.widthOfTextAtSize(line, fontSize);\n    if (width < maxWidth) {\n      var remainder = input.substring(lastWhitespaceIdx) || undefined;\n      return {\n        line: line,\n        encoded: encoded,\n        width: width,\n        remainder: remainder\n      };\n    }\n    lastWhitespaceIdx = (_a = lastIndexOfWhitespace(line)) !== null && _a !== void 0 ? _a : 0;\n  }\n  // We were unable to split the input enough to get a chunk that would fit\n  // within the specified `maxWidth` so we'll just return everything\n  return {\n    line: input,\n    encoded: font.encodeText(input),\n    width: font.widthOfTextAtSize(input, fontSize),\n    remainder: undefined\n  };\n};\nexport var layoutMultilineText = function (text, _a) {\n  var alignment = _a.alignment,\n    fontSize = _a.fontSize,\n    font = _a.font,\n    bounds = _a.bounds;\n  var lines = lineSplit(cleanText(text));\n  if (fontSize === undefined || fontSize === 0) {\n    fontSize = computeFontSize(lines, font, bounds, true);\n  }\n  var height = font.heightAtSize(fontSize);\n  var lineHeight = height + height * 0.2;\n  var textLines = [];\n  var minX = bounds.x;\n  var minY = bounds.y;\n  var maxX = bounds.x + bounds.width;\n  var maxY = bounds.y + bounds.height;\n  var y = bounds.y + bounds.height;\n  for (var idx = 0, len = lines.length; idx < len; idx++) {\n    var prevRemainder = lines[idx];\n    while (prevRemainder !== undefined) {\n      var _b = splitOutLines(prevRemainder, bounds.width, font, fontSize),\n        line = _b.line,\n        encoded = _b.encoded,\n        width = _b.width,\n        remainder = _b.remainder;\n      // prettier-ignore\n      var x = alignment === TextAlignment.Left ? bounds.x : alignment === TextAlignment.Center ? bounds.x + bounds.width / 2 - width / 2 : alignment === TextAlignment.Right ? bounds.x + bounds.width - width : bounds.x;\n      y -= lineHeight;\n      if (x < minX) minX = x;\n      if (y < minY) minY = y;\n      if (x + width > maxX) maxX = x + width;\n      if (y + height > maxY) maxY = y + height;\n      textLines.push({\n        text: line,\n        encoded: encoded,\n        width: width,\n        height: height,\n        x: x,\n        y: y\n      });\n      // Only trim lines that we had to split ourselves. So we won't trim lines\n      // that the user provided themselves with whitespace.\n      prevRemainder = remainder === null || remainder === void 0 ? void 0 : remainder.trim();\n    }\n  }\n  return {\n    fontSize: fontSize,\n    lineHeight: lineHeight,\n    lines: textLines,\n    bounds: {\n      x: minX,\n      y: minY,\n      width: maxX - minX,\n      height: maxY - minY\n    }\n  };\n};\nexport var layoutCombedText = function (text, _a) {\n  var fontSize = _a.fontSize,\n    font = _a.font,\n    bounds = _a.bounds,\n    cellCount = _a.cellCount;\n  var line = mergeLines(cleanText(text));\n  if (line.length > cellCount) {\n    throw new CombedTextLayoutError(line.length, cellCount);\n  }\n  if (fontSize === undefined || fontSize === 0) {\n    fontSize = computeCombedFontSize(line, font, bounds, cellCount);\n  }\n  var cellWidth = bounds.width / cellCount;\n  var height = font.heightAtSize(fontSize, {\n    descender: false\n  });\n  var y = bounds.y + (bounds.height / 2 - height / 2);\n  var cells = [];\n  var minX = bounds.x;\n  var minY = bounds.y;\n  var maxX = bounds.x + bounds.width;\n  var maxY = bounds.y + bounds.height;\n  var cellOffset = 0;\n  var charOffset = 0;\n  while (cellOffset < cellCount) {\n    var _b = charAtIndex(line, charOffset),\n      char = _b[0],\n      charLength = _b[1];\n    var encoded = font.encodeText(char);\n    var width = font.widthOfTextAtSize(char, fontSize);\n    var cellCenter = bounds.x + (cellWidth * cellOffset + cellWidth / 2);\n    var x = cellCenter - width / 2;\n    if (x < minX) minX = x;\n    if (y < minY) minY = y;\n    if (x + width > maxX) maxX = x + width;\n    if (y + height > maxY) maxY = y + height;\n    cells.push({\n      text: line,\n      encoded: encoded,\n      width: width,\n      height: height,\n      x: x,\n      y: y\n    });\n    cellOffset += 1;\n    charOffset += charLength;\n  }\n  return {\n    fontSize: fontSize,\n    cells: cells,\n    bounds: {\n      x: minX,\n      y: minY,\n      width: maxX - minX,\n      height: maxY - minY\n    }\n  };\n};\nexport var layoutSinglelineText = function (text, _a) {\n  var alignment = _a.alignment,\n    fontSize = _a.fontSize,\n    font = _a.font,\n    bounds = _a.bounds;\n  var line = mergeLines(cleanText(text));\n  if (fontSize === undefined || fontSize === 0) {\n    fontSize = computeFontSize([line], font, bounds);\n  }\n  var encoded = font.encodeText(line);\n  var width = font.widthOfTextAtSize(line, fontSize);\n  var height = font.heightAtSize(fontSize, {\n    descender: false\n  });\n  // prettier-ignore\n  var x = alignment === TextAlignment.Left ? bounds.x : alignment === TextAlignment.Center ? bounds.x + bounds.width / 2 - width / 2 : alignment === TextAlignment.Right ? bounds.x + bounds.width - width : bounds.x;\n  var y = bounds.y + (bounds.height / 2 - height / 2);\n  return {\n    fontSize: fontSize,\n    line: {\n      text: line,\n      encoded: encoded,\n      width: width,\n      height: height,\n      x: x,\n      y: y\n    },\n    bounds: {\n      x: x,\n      y: y,\n      width: width,\n      height: height\n    }\n  };\n};","map":{"version":3,"mappings":"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","names":["CombedTextLayoutError","TextAlignment","cleanText","lineSplit","mergeLines","charAtIndex","charSplit","MIN_FONT_SIZE","MAX_FONT_SIZE","computeFontSize","lines","font","bounds","multiline","fontSize","linesUsed","lineIdx","lineLen","length","line","words","split","spaceInLineRemaining","width","idx","len","isLastWord","word","widthOfWord","widthOfTextAtSize","height","heightAtSize","lineHeight","totalHeight","Math","abs","computeCombedFontSize","cellCount","cellWidth","cellHeight","chars","c","tooLong","descender","lastIndexOfWhitespace","test","undefined","splitOutLines","input","maxWidth","lastWhitespaceIdx","substring","encoded","encodeText","remainder","layoutMultilineText","text","_a","alignment","textLines","minX","x","minY","y","maxX","maxY","prevRemainder","Left","Center","Right","push","trim","layoutCombedText","cells","cellOffset","charOffset","char","charLength","cellCenter","layoutSinglelineText"],"sourceRoot":"","sources":["../../../src/api/text/layout.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}