{"ast":null,"code":"import { __awaiter, __generator } from \"tslib\";\nimport { PDFName, PDFArray, PDFDict, PDFHexString } from \"../core\";\n/**\n * Represents JavaScript that has been embedded in a [[PDFDocument]].\n */\nvar PDFJavaScript = /** @class */function () {\n  function PDFJavaScript(ref, doc, embedder) {\n    this.alreadyEmbedded = false;\n    this.ref = ref;\n    this.doc = doc;\n    this.embedder = embedder;\n  }\n  /**\n   * > **NOTE:** You probably don't need to call this method directly. The\n   * > [[PDFDocument.save]] and [[PDFDocument.saveAsBase64]] methods will\n   * > automatically ensure all JavaScripts get embedded.\n   *\n   * Embed this JavaScript in its document.\n   *\n   * @returns Resolves when the embedding is complete.\n   */\n  PDFJavaScript.prototype.embed = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var _a, catalog, context, ref, Names, Javascript, JSNames;\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            if (!!this.alreadyEmbedded) return [3 /*break*/, 2];\n            _a = this.doc, catalog = _a.catalog, context = _a.context;\n            return [4 /*yield*/, this.embedder.embedIntoContext(this.doc.context, this.ref)];\n          case 1:\n            ref = _b.sent();\n            if (!catalog.has(PDFName.of('Names'))) {\n              catalog.set(PDFName.of('Names'), context.obj({}));\n            }\n            Names = catalog.lookup(PDFName.of('Names'), PDFDict);\n            if (!Names.has(PDFName.of('JavaScript'))) {\n              Names.set(PDFName.of('JavaScript'), context.obj({}));\n            }\n            Javascript = Names.lookup(PDFName.of('JavaScript'), PDFDict);\n            if (!Javascript.has(PDFName.of('Names'))) {\n              Javascript.set(PDFName.of('Names'), context.obj([]));\n            }\n            JSNames = Javascript.lookup(PDFName.of('Names'), PDFArray);\n            JSNames.push(PDFHexString.fromText(this.embedder.scriptName));\n            JSNames.push(ref);\n            this.alreadyEmbedded = true;\n            _b.label = 2;\n          case 2:\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n  /**\n   * > **NOTE:** You probably don't want to call this method directly. Instead,\n   * > consider using the [[PDFDocument.addJavaScript]] method, which will\n   * create instances of [[PDFJavaScript]] for you.\n   *\n   * Create an instance of [[PDFJavaScript]] from an existing ref and script\n   *\n   * @param ref The unique reference for this script.\n   * @param doc The document to which the script will belong.\n   * @param embedder The embedder that will be used to embed the script.\n   */\n  PDFJavaScript.of = function (ref, doc, embedder) {\n    return new PDFJavaScript(ref, doc, embedder);\n  };\n  return PDFJavaScript;\n}();\nexport default PDFJavaScript;","map":{"version":3,"mappings":";AAGA,SAASA,OAAO,EAAEC,QAAQ,EAAEC,OAAO,EAAEC,YAAY,QAAU;AAE3D;;;AAGA;EAwBE,uBACEC,GAAW,EACXC,GAAgB,EAChBC,QAA4B;IANtB,oBAAe,GAAG,KAAK;IAQ7B,IAAI,CAACF,GAAG,GAAGA,GAAG;IACd,IAAI,CAACC,GAAG,GAAGA,GAAG;IACd,IAAI,CAACC,QAAQ,GAAGA,QAAQ;EAC1B;EAEA;;;;;;;;;EASMC,6BAAK,GAAX;;;;;;iBACM,CAAC,IAAI,CAACC,eAAe,EAArB;YACIC,KAAuB,IAAI,CAACJ,GAAG,EAA7BK,OAAO,eAAEC,OAAO;YAEZ,qBAAM,IAAI,CAACL,QAAQ,CAACM,gBAAgB,CAC9C,IAAI,CAACP,GAAG,CAACM,OAAO,EAChB,IAAI,CAACP,GAAG,CACT;;YAHKA,GAAG,GAAGS,SAGX;YAED,IAAI,CAACH,OAAO,CAACI,GAAG,CAACd,OAAO,CAACe,EAAE,CAAC,OAAO,CAAC,CAAC,EAAE;cACrCL,OAAO,CAACM,GAAG,CAAChB,OAAO,CAACe,EAAE,CAAC,OAAO,CAAC,EAAEJ,OAAO,CAACM,GAAG,CAAC,EAAE,CAAC,CAAC;;YAE7CC,KAAK,GAAGR,OAAO,CAACS,MAAM,CAACnB,OAAO,CAACe,EAAE,CAAC,OAAO,CAAC,EAAEb,OAAO,CAAC;YAE1D,IAAI,CAACgB,KAAK,CAACJ,GAAG,CAACd,OAAO,CAACe,EAAE,CAAC,YAAY,CAAC,CAAC,EAAE;cACxCG,KAAK,CAACF,GAAG,CAAChB,OAAO,CAACe,EAAE,CAAC,YAAY,CAAC,EAAEJ,OAAO,CAACM,GAAG,CAAC,EAAE,CAAC,CAAC;;YAEhDG,UAAU,GAAGF,KAAK,CAACC,MAAM,CAACnB,OAAO,CAACe,EAAE,CAAC,YAAY,CAAC,EAAEb,OAAO,CAAC;YAElE,IAAI,CAACkB,UAAU,CAACN,GAAG,CAACd,OAAO,CAACe,EAAE,CAAC,OAAO,CAAC,CAAC,EAAE;cACxCK,UAAU,CAACJ,GAAG,CAAChB,OAAO,CAACe,EAAE,CAAC,OAAO,CAAC,EAAEJ,OAAO,CAACM,GAAG,CAAC,EAAE,CAAC,CAAC;;YAEhDI,OAAO,GAAGD,UAAU,CAACD,MAAM,CAACnB,OAAO,CAACe,EAAE,CAAC,OAAO,CAAC,EAAEd,QAAQ,CAAC;YAEhEoB,OAAO,CAACC,IAAI,CAACnB,YAAY,CAACoB,QAAQ,CAAC,IAAI,CAACjB,QAAQ,CAACkB,UAAU,CAAC,CAAC;YAC7DH,OAAO,CAACC,IAAI,CAAClB,GAAG,CAAC;YAEjB,IAAI,CAACI,eAAe,GAAG,IAAI;;;;;;;GAE9B;EAvED;;;;;;;;;;;EAWOD,gBAAE,GAAG,UAACH,GAAW,EAAEC,GAAgB,EAAEC,QAA4B;IACtE,WAAIC,aAAa,CAACH,GAAG,EAAEC,GAAG,EAAEC,QAAQ,CAAC;EAArC,CAAqC;EA4DzC,oBAAC;CAAA,EAzED;eAAqBC,aAAa","names":["PDFName","PDFArray","PDFDict","PDFHexString","ref","doc","embedder","PDFJavaScript","alreadyEmbedded","_a","catalog","context","embedIntoContext","_b","has","of","set","obj","Names","lookup","Javascript","JSNames","push","fromText","scriptName"],"sourceRoot":"","sources":["../../src/api/PDFJavaScript.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}