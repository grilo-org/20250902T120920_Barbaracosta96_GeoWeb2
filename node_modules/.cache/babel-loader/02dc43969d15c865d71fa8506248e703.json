{"ast":null,"code":"import PDFDict from \"../objects/PDFDict\";\nimport PDFName from \"../objects/PDFName\";\nimport PDFStream from \"../objects/PDFStream\";\nimport PDFArray from \"../objects/PDFArray\";\nimport PDFRef from \"../objects/PDFRef\";\nimport PDFNumber from \"../objects/PDFNumber\";\nvar PDFAnnotation = /** @class */function () {\n  function PDFAnnotation(dict) {\n    this.dict = dict;\n  }\n  // This is technically required by the PDF spec\n  PDFAnnotation.prototype.Rect = function () {\n    return this.dict.lookup(PDFName.of('Rect'), PDFArray);\n  };\n  PDFAnnotation.prototype.AP = function () {\n    return this.dict.lookupMaybe(PDFName.of('AP'), PDFDict);\n  };\n  PDFAnnotation.prototype.F = function () {\n    var numberOrRef = this.dict.lookup(PDFName.of('F'));\n    return this.dict.context.lookupMaybe(numberOrRef, PDFNumber);\n  };\n  PDFAnnotation.prototype.getRectangle = function () {\n    var _a;\n    var Rect = this.Rect();\n    return (_a = Rect === null || Rect === void 0 ? void 0 : Rect.asRectangle()) !== null && _a !== void 0 ? _a : {\n      x: 0,\n      y: 0,\n      width: 0,\n      height: 0\n    };\n  };\n  PDFAnnotation.prototype.setRectangle = function (rect) {\n    var x = rect.x,\n      y = rect.y,\n      width = rect.width,\n      height = rect.height;\n    var Rect = this.dict.context.obj([x, y, x + width, y + height]);\n    this.dict.set(PDFName.of('Rect'), Rect);\n  };\n  PDFAnnotation.prototype.getAppearanceState = function () {\n    var AS = this.dict.lookup(PDFName.of('AS'));\n    if (AS instanceof PDFName) return AS;\n    return undefined;\n  };\n  PDFAnnotation.prototype.setAppearanceState = function (state) {\n    this.dict.set(PDFName.of('AS'), state);\n  };\n  PDFAnnotation.prototype.setAppearances = function (appearances) {\n    this.dict.set(PDFName.of('AP'), appearances);\n  };\n  PDFAnnotation.prototype.ensureAP = function () {\n    var AP = this.AP();\n    if (!AP) {\n      AP = this.dict.context.obj({});\n      this.dict.set(PDFName.of('AP'), AP);\n    }\n    return AP;\n  };\n  PDFAnnotation.prototype.getNormalAppearance = function () {\n    var AP = this.ensureAP();\n    var N = AP.get(PDFName.of('N'));\n    if (N instanceof PDFRef || N instanceof PDFDict) return N;\n    throw new Error(\"Unexpected N type: \" + (N === null || N === void 0 ? void 0 : N.constructor.name));\n  };\n  /** @param appearance A PDFDict or PDFStream (direct or ref) */\n  PDFAnnotation.prototype.setNormalAppearance = function (appearance) {\n    var AP = this.ensureAP();\n    AP.set(PDFName.of('N'), appearance);\n  };\n  /** @param appearance A PDFDict or PDFStream (direct or ref) */\n  PDFAnnotation.prototype.setRolloverAppearance = function (appearance) {\n    var AP = this.ensureAP();\n    AP.set(PDFName.of('R'), appearance);\n  };\n  /** @param appearance A PDFDict or PDFStream (direct or ref) */\n  PDFAnnotation.prototype.setDownAppearance = function (appearance) {\n    var AP = this.ensureAP();\n    AP.set(PDFName.of('D'), appearance);\n  };\n  PDFAnnotation.prototype.removeRolloverAppearance = function () {\n    var AP = this.AP();\n    AP === null || AP === void 0 ? void 0 : AP.delete(PDFName.of('R'));\n  };\n  PDFAnnotation.prototype.removeDownAppearance = function () {\n    var AP = this.AP();\n    AP === null || AP === void 0 ? void 0 : AP.delete(PDFName.of('D'));\n  };\n  PDFAnnotation.prototype.getAppearances = function () {\n    var AP = this.AP();\n    if (!AP) return undefined;\n    var N = AP.lookup(PDFName.of('N'), PDFDict, PDFStream);\n    var R = AP.lookupMaybe(PDFName.of('R'), PDFDict, PDFStream);\n    var D = AP.lookupMaybe(PDFName.of('D'), PDFDict, PDFStream);\n    return {\n      normal: N,\n      rollover: R,\n      down: D\n    };\n  };\n  PDFAnnotation.prototype.getFlags = function () {\n    var _a, _b;\n    return (_b = (_a = this.F()) === null || _a === void 0 ? void 0 : _a.asNumber()) !== null && _b !== void 0 ? _b : 0;\n  };\n  PDFAnnotation.prototype.setFlags = function (flags) {\n    this.dict.set(PDFName.of('F'), PDFNumber.of(flags));\n  };\n  PDFAnnotation.prototype.hasFlag = function (flag) {\n    var flags = this.getFlags();\n    return (flags & flag) !== 0;\n  };\n  PDFAnnotation.prototype.setFlag = function (flag) {\n    var flags = this.getFlags();\n    this.setFlags(flags | flag);\n  };\n  PDFAnnotation.prototype.clearFlag = function (flag) {\n    var flags = this.getFlags();\n    this.setFlags(flags & ~flag);\n  };\n  PDFAnnotation.prototype.setFlagTo = function (flag, enable) {\n    if (enable) this.setFlag(flag);else this.clearFlag(flag);\n  };\n  PDFAnnotation.fromDict = function (dict) {\n    return new PDFAnnotation(dict);\n  };\n  return PDFAnnotation;\n}();\nexport default PDFAnnotation;","map":{"version":3,"mappings":"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","names":["PDFDict","PDFName","PDFStream","PDFArray","PDFRef","PDFNumber","dict","PDFAnnotation","lookup","of","lookupMaybe","numberOrRef","context","Rect","asRectangle","x","y","width","height","rect","obj","set","AS","undefined","state","appearances","AP","ensureAP","N","get","Error","constructor","name","appearance","delete","R","D","normal","rollover","down","F","asNumber","flags","flag","getFlags","setFlags","enable","setFlag","clearFlag"],"sourceRoot":"","sources":["../../../src/core/annotation/PDFAnnotation.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}