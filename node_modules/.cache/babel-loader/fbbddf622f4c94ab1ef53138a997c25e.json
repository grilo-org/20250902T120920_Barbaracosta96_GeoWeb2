{"ast":null,"code":"import { __extends } from \"tslib\";\nimport PDFName from \"../objects/PDFName\";\nimport PDFNumber from \"../objects/PDFNumber\";\nimport PDFFlateStream from \"./PDFFlateStream\";\nimport CharCodes from \"../syntax/CharCodes\";\nimport { copyStringIntoBuffer, last } from \"../../utils\";\nvar PDFObjectStream = /** @class */function (_super) {\n  __extends(PDFObjectStream, _super);\n  function PDFObjectStream(context, objects, encode) {\n    if (encode === void 0) {\n      encode = true;\n    }\n    var _this = _super.call(this, context.obj({}), encode) || this;\n    _this.objects = objects;\n    _this.offsets = _this.computeObjectOffsets();\n    _this.offsetsString = _this.computeOffsetsString();\n    _this.dict.set(PDFName.of('Type'), PDFName.of('ObjStm'));\n    _this.dict.set(PDFName.of('N'), PDFNumber.of(_this.objects.length));\n    _this.dict.set(PDFName.of('First'), PDFNumber.of(_this.offsetsString.length));\n    return _this;\n  }\n  PDFObjectStream.prototype.getObjectsCount = function () {\n    return this.objects.length;\n  };\n  PDFObjectStream.prototype.clone = function (context) {\n    return PDFObjectStream.withContextAndObjects(context || this.dict.context, this.objects.slice(), this.encode);\n  };\n  PDFObjectStream.prototype.getContentsString = function () {\n    var value = this.offsetsString;\n    for (var idx = 0, len = this.objects.length; idx < len; idx++) {\n      var _a = this.objects[idx],\n        object = _a[1];\n      value += object + \"\\n\";\n    }\n    return value;\n  };\n  PDFObjectStream.prototype.getUnencodedContents = function () {\n    var buffer = new Uint8Array(this.getUnencodedContentsSize());\n    var offset = copyStringIntoBuffer(this.offsetsString, buffer, 0);\n    for (var idx = 0, len = this.objects.length; idx < len; idx++) {\n      var _a = this.objects[idx],\n        object = _a[1];\n      offset += object.copyBytesInto(buffer, offset);\n      buffer[offset++] = CharCodes.Newline;\n    }\n    return buffer;\n  };\n  PDFObjectStream.prototype.getUnencodedContentsSize = function () {\n    return this.offsetsString.length + last(this.offsets)[1] + last(this.objects)[1].sizeInBytes() + 1;\n  };\n  PDFObjectStream.prototype.computeOffsetsString = function () {\n    var offsetsString = '';\n    for (var idx = 0, len = this.offsets.length; idx < len; idx++) {\n      var _a = this.offsets[idx],\n        objectNumber = _a[0],\n        offset = _a[1];\n      offsetsString += objectNumber + \" \" + offset + \" \";\n    }\n    return offsetsString;\n  };\n  PDFObjectStream.prototype.computeObjectOffsets = function () {\n    var offset = 0;\n    var offsets = new Array(this.objects.length);\n    for (var idx = 0, len = this.objects.length; idx < len; idx++) {\n      var _a = this.objects[idx],\n        ref = _a[0],\n        object = _a[1];\n      offsets[idx] = [ref.objectNumber, offset];\n      offset += object.sizeInBytes() + 1; // '\\n'\n    }\n\n    return offsets;\n  };\n  PDFObjectStream.withContextAndObjects = function (context, objects, encode) {\n    if (encode === void 0) {\n      encode = true;\n    }\n    return new PDFObjectStream(context, objects, encode);\n  };\n  return PDFObjectStream;\n}(PDFFlateStream);\nexport default PDFObjectStream;","map":{"version":3,"mappings":"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","names":["PDFName","PDFNumber","PDFFlateStream","CharCodes","copyStringIntoBuffer","last","__extends","context","objects","encode","_super","obj","_this","offsets","computeObjectOffsets","offsetsString","computeOffsetsString","dict","set","of","length","PDFObjectStream","withContextAndObjects","slice","value","idx","len","object","buffer","Uint8Array","getUnencodedContentsSize","offset","copyBytesInto","Newline","sizeInBytes","objectNumber","Array","ref"],"sourceRoot":"","sources":["../../../src/core/structures/PDFObjectStream.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}